% $id$ 
% luca.sty
% by Luca de Alfaro
% Includes also: 
% equations.sty, comment.sty, call.sty, theorem.sty 

% ================================================================ equations.sty

% This file, equations.sty (August 1988), contains a collection of macros
% to aid in constructing displayed equations in LaTeX.  Written by
%   Charles Karney
%   Plasma Physics Laboratory   Phone:   +1 609 243 2607
%   Princeton University        MFEnet:  Karney@PPC.MFEnet
%   PO Box 451                  ARPAnet: Karney%PPC.MFEnet@NMFECC.ARPA
%   Princeton, NJ 08543-0451    Bitnet:  Karney%PPC.MFEnet@ANLVMS.Bitnet
% with some ideas and macros borrowed from John Hobby and Stephen Gildea.

% --------------------USER DOCUMENTATION--------------------

% Use this as a style option, e.g.,
%     \documentstyle[equations]{article}
% These probably don't work in conjunction with the leqno option.

% This implements the following:

% (1) \yesnumber turns on an equation number in an eqnarray* environment
% (just as \nonumber turns it off in an eqnarray environment).  E.g.,
%     \begin{eqnarray*}
%        a &=& b \\
%          & & + c \\
%          & & + d \\
%          & & + e \\
%          & & + f \\
%          & & + g \yesnumber
%     \end{eqnarray*}

% (2) The eqalign environment is just like Plain TeX's \eqalign.  E.g.,
%     \begin{equation}
%           \begin{eqalign}
%              a &= b, \\
%              c &= d.
%           \end{eqalign}
%     \end{equation}
% Note that \begin{equation} \end{equation} or equivalent is needed.

% (3) The eqalignno environment is just like Plain TeX's \eqalignno.  E.g.,
%     \begin{eqalignno}
%        a &= b, \label{foo}\\
%        c &= d. \label{bar}
%     \end{eqalignno}
% Note the absence of \begin{equation} \end{equation}.  \nonumber can be used
% to suppress the equation number.  eqalignno* is the same except that the
% equation numbers are suppressed (unless a \yesnumber appears).

% (4) The eqaligntwo environment is a two-equation per line equivalent of
% eqalignno.  E.g.,
%     \begin{eqaligntwo}
%        a &= b, & x &= y, \label{foo} \\
%        c &= d, & z &= w. \label{bar}
%     \end{eqaligntwo}
% eqaligntwo* is defined similarly.

% (5) The cases environment is just like Plain TeX's \cases.  E.g.,
%     \begin{equation}
%        u(x) =
%           \begin{cases}
%             0, & for $x < 0$,
%             1, & for $x \ge 0$.
%           \end{cases}
%     \end{equation}
% Note the first column is treated as math, the second column as text.

% (6) I've borrowed John Hobby's modifications to the eqnarray environment
% (to fix up the spacing around the operator), and to the \big, \bigg, etc.
% operators (to make them scale with the point size).

% (7) I've borrowed Stephen Gildea's subequations environment, and fixed it
% so that it ignores spaces after the environment and so that you can refer
% both to the overall set of equations and to individual subequations.  E.g.,
%     \begin{subequations} \label{foo}
%       \begin{eqalignno}
%          a &= b, \label{foo-a} \\
%          c &= d, \label{foo-b}
%       \end{eqalignno}
%       text text text text ...
%       \begin{equation}
%          e = f. \label{foo-c}
%       \end{equation}
%     \end{subequations}
% Now \ref{foo}, \ref{foo-a}, \ref{foo-b}, \ref{foo-c}, produce 1, 1a, 1b,
% 1c.

% --------------------END OF USER DOCUMENTATION--------------------

% Fix up eqnarray* so that \yesnumber and \nonumber do the obvious things 
\newif\if@defeqnsw \@defeqnswtrue

% This is John Hobby's (hobby@research.att.com) version to fix up the spacing.
\def\eqnarray{\stepcounter{equation}\let\@currentlabel=\theequation
\if@defeqnsw\global\@eqnswtrue\else\global\@eqnswfalse\fi
\global\@eqnswtrue
\tabskip\@centering\let\\=\@eqncr
$$\halign to \displaywidth\bgroup\hfil\global\@eqcnt\z@
  $\displaystyle\tabskip\z@{##}$&\global\@eqcnt\@ne 
  \hfil$\displaystyle{{}##{}}$\hfil
  &\global\@eqcnt\tw@ $\displaystyle{##}$\hfil 
  \tabskip\@centering&\llap{##}\tabskip\z@\cr}

\def\yesnumber{\global\@eqnswtrue}

\def\@@eqncr{\let\@tempa\relax\global\advance\@eqcnt by \@ne
    \ifcase\@eqcnt \def\@tempa{& & & &}\or \def\@tempa{& & &}\or
     \def\@tempa{& &}\or \def\@tempa{&}\else\fi 
     \@tempa \if@eqnsw\@eqnnum\stepcounter{equation}\fi
     \if@defeqnsw\global\@eqnswtrue\else\global\@eqnswfalse\fi
     \global\@eqcnt\z@\cr}

% Several formulas like \eqalign (to go inside \begin{equation}
% \end{equation} or $$ $$.

\def\@eqnacr{{\ifnum0=`}\fi\@ifstar{\@yeqnacr}{\@yeqnacr}}

\def\@yeqnacr{\@ifnextchar [{\@xeqnacr}{\@xeqnacr[\z@]}}

\def\@xeqnacr[#1]{\ifnum0=`{\fi}\cr \noalign{\vskip\jot\vskip #1\relax}}

\def\eqalign{\null\,\vcenter\bgroup\openup1\jot \m@th \let\\=\@eqnacr
\ialign\bgroup\strut
\hfil$\displaystyle{##}$&$\displaystyle{{}##}$\hfil\crcr}
\def\endeqalign{\crcr\egroup\egroup\,}

% \cases

\def\cases{\left\{\,\vcenter\bgroup\normalbaselines\m@th \let\\=\@eqnacr
    \ialign\bgroup$##\hfil$&\quad##\hfil\crcr}
\def\endcases{\crcr\egroup\egroup\right.}

% Several formulas like \eqalignno (doesn't need the $$ $$)

\def\eqalignno{\stepcounter{equation}\let\@currentlabel=\theequation
\if@defeqnsw\global\@eqnswtrue\else\global\@eqnswfalse\fi
\let\\=\@eqncr
$$\displ@y \tabskip\@centering \halign to \displaywidth\bgroup
  \global\@eqcnt\@ne\hfil
  $\@lign\displaystyle{##}$\tabskip\z@skip&\global\@eqcnt\tw@
  $\@lign\displaystyle{{}##}$\hfil\tabskip\@centering&
  \llap{\@lign##}\tabskip\z@skip\crcr}

\def\endeqalignno{\@@eqncr\egroup
      \global\advance\c@equation\m@ne$$\global\@ignoretrue}


% Here's the eqalignno* environment:

\@namedef{eqalignno*}{\@defeqnswfalse\eqalignno}
\@namedef{endeqalignno*}{\endeqalignno}

% Two formulas like \eqalignno (doesn't need the $$ $$)

\def\eqaligntwo{\stepcounter{equation}\let\@currentlabel=\theequation
\if@defeqnsw\global\@eqnswtrue\else\global\@eqnswfalse\fi
\let\\=\@eqncr
$$\displ@y \tabskip\@centering \halign to \displaywidth\bgroup
  \global\@eqcnt\m@ne\hfil
  $\@lign\displaystyle{##}$\tabskip\z@skip&\global\@eqcnt\z@
  $\@lign\displaystyle{{}##}$\hfil\qquad&\global\@eqcnt\@ne
  \hfil$\@lign\displaystyle{##}$&\global\@eqcnt\tw@
  $\@lign\displaystyle{{}##}$\hfil\tabskip\@centering&
  \llap{\@lign##}\tabskip\z@skip\crcr}

\def\endeqaligntwo{\@@eqncr\egroup
      \global\advance\c@equation\m@ne$$\global\@ignoretrue}

\@namedef{eqaligntwo*}{\@defeqnswfalse\eqaligntwo}
\@namedef{endeqaligntwo*}{\endeqaligntwo}

% subequations
%%% File: subeqn.sty
%%% The subequations environment %%%
%
% Within the subequations environment, the only change is that
% equations are labeled differently.  The number stays the same,
% and lower case letters are appended.  For example, if after doing
% three equations, numbered 1, 2, and 3, you start a subequations
% environmment and do three more equations, they will be numbered
% 4a, 4b, and 4c.  After you end the subequations environment, the
% next equation will be numbered 5.
%
% Both text and equations can be put inside the subequations environment.
%
% If you make any improvements, I'd like to hear about them.
%
% Stephen Gildea
% MIT Earth Resources Lab
% Cambridge, Mass. 02139
% mit-erl!gildea
% gildea@erl.mit.edu
%
\newtoks\@stequation

\def\subequations{\refstepcounter{equation}%
  \edef\@savedequation{\the\c@equation}%
  \@stequation=\expandafter{\theequation}%   %only want \theequation
  \edef\@savedtheequation{\the\@stequation}% %expanded once
  \edef\oldtheequation{\theequation}%
  \setcounter{equation}{0}%
  \def\theequation{\oldtheequation\alph{equation}}}

\def\endsubequations{%
  \setcounter{equation}{\@savedequation}%
  \@stequation=\expandafter{\@savedtheequation}%
  \edef\theequation{\the\@stequation}%
  \global\@ignoretrue}

% More from John Hobby
% Fix Plain's \bigl, \Bigl, etc. macros so that they try to scale with
% LaTeX size changes.  This uses the fact that \@setsize sets \ht\strutbox
% to be 70% of the normal unstretched baselineskip.

\def\big#1{{\hbox{$\left#1\vcenter to1.428\ht\strutbox{}\right.\n@space$}}}
\def\Big#1{{\hbox{$\left#1\vcenter to2.142\ht\strutbox{}\right.\n@space$}}}
\def\bigg#1{{\hbox{$\left#1\vcenter to2.857\ht\strutbox{}\right.\n@space$}}}
\def\Bigg#1{{\hbox{$\left#1\vcenter to3.571\ht\strutbox{}\right.\n@space$}}}

% ===================================================================comment.sty 

% comment.sty
% 25-Oct-89
% By Ed -- modified from verbatim in /usr/loca/lib/tex82/latex.tex

% \begin{comment}
% \end{comment}

\begingroup \catcode `|=0 \catcode `[= 1
\catcode`]=2 \catcode `\{=12 \catcode `\}=12
\catcode`\\=12 |gdef|@xcomment#1\end{comment}[|end[comment]]
|endgroup

\def\@comment{\let\do\@makeother \dospecials\catcode`\^^M=10\def\par{}}

\def\begincomment{\@comment\@xcomment}

\newenvironment{comment}{\begincomment}{}

% =========================================================theorem.sty

% command to end a proof or definition:
\def\qed{\rule{0.4em}{1.4ex}}

% space at the beginning of an environment:
\def\@envspa{\hspace{0.3em}}
\def\@sa{\hspace{-0.2em}}
\def\@sb{\hspace{0.5em}}
\def\@sc{\hspace{-0.1em}}
\def\sk{\smallskip}		% space before and after theorems

% new environments:

\newtheorem{@protheo}{Theorem}
\newenvironment{theo}[1]{\begin{@protheo}\@sa{\rm \bf #1}\@sb\it}{\end{@protheo}}

\newtheorem{@prodefi}{Definition}
\newenvironment{defi}[1]{\begin{@prodefi} \@sa{\rm\bf #1}\@sb\rm}{\end{@prodefi}}

\newtheorem{@proconstr}{Construction}
\newenvironment{constr}[1]{\begin{@proconstr} \@sa{\rm\bf #1}\@sb\rm}{\end{@proconstr}}

\newtheorem{@proalgo}{Algorithm}
\newenvironment{algo}[1]{\begin{@proalgo} \@sa{\rm\bf #1}\@sb\rm}{\end{@proalgo}}

\newtheorem{@procon}{Condition}
\newenvironment{cond}[1]{\begin{@procon} \@sa{\rm\bf #1}\@sb\rm}{\end{@procon}}

\newtheorem{@prorestr}{Restriction}
\newenvironment{restr}[1]{\begin{@prorestr} \@sa{\rm\bf #1}\@sb\rm}{\end{@prorestr}}

\newtheorem{@prolem}{Lemma}
\newenvironment{lem}[1]{\begin{@prolem}\@sa{\rm\bf #1}\@sb\it}{\end{@prolem}}

\newtheorem{@procor}{Corollary}
\newenvironment{cor}[1]{\begin{@procor}\@sa{\rm \bf #1}\@sb\it}{\end{@procor}}

\newtheorem{@proprop}{Proposition}
\newenvironment{prop}[1]{\begin{@proprop}\@sa{\rm \bf #1}\@sb\it}{\end{@proprop}}

\newtheorem{@proassu}{Assumption}
\newenvironment{assu}[1]{\begin{@proassu}\@sa{\rm \bf #1}\@sb\rm}{\end{@proassu}}

\newtheorem{@proprob}{Problem}
\newenvironment{prob}{\begin{@proprob}\@envspa\rm}{\end{@proprob}}

\newtheorem{@prolprob}{Linear Programming Problem}
\newenvironment{lpprob}{\begin{@prolprob}\@envspa\rm}{\end{@prolprob}}

\newtheorem{@proexe}{Exercise}
\newenvironment{exer}{\begin{@proexe}\@envspa\rm}{\qed\end{@proexe}}

\newtheorem{@proexa}{Example}
\newenvironment{examp}[1]{\begin{@proexa}\@sa{\rm \bf #1}\@sb\rm}{\end{@proexa}}

\newtheorem{@pronota}{Note}
\newenvironment{nota}{\begin{@pronota} \rm \footnotesize}{\par\end{@pronota}}

\newtheorem{@prorego}{Rule}
\newenvironment{regola}[1]{\begin{@prorego} \@sa{\rm\bf #1}\@sb\rm}{\end{@prorego}}

\newtheorem{@proassert}{Assertion}
\newenvironment{assertion}[1]{\begin{@proassert} \@sa{\rm\bf #1}\@sb\it}{\end{@proassert}}

\def\@proofbugbegin{

\noindent}

\def\@proofbugend{

\medskip}

\renewenvironment{proof}{\@proofbugbegin {\bf Proof.}\@envspa}{
\@proofbugend\smallskip}

\newenvironment{prsk}{\paragraph{Proof {\rm (sketch).}}}{\medskip}

\def\proofsketch{\paragraph{Proof {\rm (sketch).}}}

\def\subpar#1{\par \smallskip \noindent {\em #1}}

% ===================================================================== call.sty 

\def\cala{{\cal A}}
\def\calb{{\cal B}}
\def\calc{{\cal C}}
\def\cald{{\cal D}}
\def\cale{{\cal E}}
\def\calf{{\cal F}}
\def\calg{{\cal G}}
\def\calh{{\cal H}}
\def\cali{{\cal I}}
\def\calj{{\cal J}}
\def\calk{{\cal K}}
\def\call{{\cal L}}
\def\calm{{\cal M}}
\def\caln{{\cal N}}
\def\calo{{\cal O}}
\def\calp{{\cal P}}
\def\calq{{\cal Q}}
\def\calr{{\cal R}}
\def\cals{{\cal S}}
\def\calt{{\cal T}}
\def\calu{{\cal U}}
\def\calv{{\cal V}}
\def\calw{{\cal W}}
\def\calx{{\cal X}}
\def\caly{{\cal Y}}
\def\calz{{\cal Z}}

% ========================================================== (old tl.sty, edited)

% Generic mathematical symbols 

\def\eqpun{\;}				% space after eq for punct
\def\subs{\subseteq}
\def\Dom{\mbox{\rm Dom}\,}
\def\Im{\mbox{\rm Im}\,}
\def\sat{\models}			% |=
\def\stsat{\mid\!\sat}			% ||=
\def\defined{\stackrel{\rm def}{=}}	% = w. 'def' on top
\def\union{\cup}
\def\inters{\cap}
\def\eqspa{\hspace*{2em}}	% space betw. equation on the same line 
\def\semb#1{[\![ #1 ]\!]}		% [[ #1 ]]
\def\tuple#1{\langle #1 \rangle}		% < #1 >
\def\set#1{\{ #1 \}}			% { #1 }
\def\go{\rightarrow} 			% -->
\def\setm{\setminus}			% \
\def\ita#1{{\text{\textit{#1}}}}        % to italicise something

% Logical operators 

\def\im{\rightarrow}			% implication
\def\biim{\,\leftrightarrow\,}		% biimplication
\def\no{\neg}				% negation (alias for \neg)
\def\und{\wedge}			% and 
\def\oder{\vee}				% or
\def\true{\mbox{\sc t}}			% T for true
\def\false{\mbox{\sc f}}		% F for false
\def\qdot{\:.\:}			% . for quantification
\def\@spartx{\hspace{0.4em}}
\def\tiff{\ita{\@spartx iff \@spartx}}
\def\tand{\ita{\@spartx and \@spartx}}
\def\tor{\ita{\@spartx or \@spartx}}
\def\timplies{\ita{\@spartx implies \@spartx}}
\def\tnot{\ita{\@spartx not \@spartx}}

% text fonts

\def\xit#1{{\text{\textit{#1}}}}
\def\xem#1{{\text{\emph{#1}}}}
\def\xtt#1{{\text{\texttt{#1}}}} 
\def\xbf#1{{\text{\textbf{#1}}}} 

% standard TL operators

\def\@bo{{\raisebox{-0.2ex}{$\Box$}}}		% internal 
\def\@dia{{\raisebox{-0.2ex}{$\Diamond$}}}	% internal 
\def\bo{\@bo}					% box
\def\diam{{\@dia}}				% diamond
\def\until{\mbox{$\:\cal U\,$}}		        % U
\def\unless{\mbox{$\:\cal W\:$}}		% W
\def\awaits{\mbox{$\:\cal W\:$}}		% W
\def\since{\mbox{$\:\cal S\:$}}		        % S
\def\backto{\mbox{$\:\cal B\:$}}		% B
\def\pbox{\mbox{\rm\makebox[0em][l]{$\@bo$}\makebox[0.8em]{--}}} % past box
\def\pdiam{\mbox{\rm\makebox[0em][l]{$\@dia$}\makebox[0.8em]{--}\hspace{0.05em}}} % past diamond
%\def\prev{\mbox{\rm\makebox[0em][l]{$\next$}\makebox[1.0em]{$-$}\,}} % previous 

\def\next{\begin{picture}(8,6)(-4,-2) \put(0,1){\circle{6}} \end{picture}}
\def\prev{\begin{picture}(8,6)(-4,-2)
\put(0,1){\circle{6}} 
\put(-3,1){\line(1,0){6}}
\end{picture}}

% To put notes
\def\mynote#1{$\clubsuit$ {\sf #1 } $\clubsuit$}

% Misc enhancements to LaTeX

\def\beq{\begin{equation}}
\def\eeq{\end{equation}}

% Naming equations or axioms: use \begin{namedeq}{EQ} to obtain
% an equation labelled with name (EQ). This does not disrupt the 
% numbering of the equations. It is to be used when the \theequation
% comand is normally set to \arabic{equation}, otherwise a new environment
% with the appropriate end text should be defined.
\newenvironment{namedeq}[1]{\renewcommand{\theequation}{#1}
	\begin{equation}}{\end{equation}
	\renewcommand{\theequation}{\arabic{equation}}
	\addtocounter{equation}{-1}}

% Naming equations or axioms, for eqnarray: use \begin{namedeqar}{EQ-} to
% obtain equations named (EQ-1), (EQ-2), ...
% As the above, this works if arabic is the default.
% \newenvironment{namedeqar}[1]{\renewcommand{\theequation}{#1\arabic{
% to be completed: need to declare a counter

% This fixes a bug in equations.sty, having to do with the way
% equations behave when fleqn.sty is also used.
% do not use eqalign. Instead:
% better version of eqalignno (with number):
\newenvironment{eqtab}{\begin{equation}
	\begin{eqalign}}{\end{eqalign}\end{equation}}
% better version of eqalignno* (without number):
\newenvironment{eqtabn}{\begin{displaymath}
	\begin{eqalign}}{\end{eqalign}\end{displaymath}}

% bold letters from llncs:

\def\bbbb{{\rm I\!B}}
\def\bbbr{{\rm I\!R}} %reelle Zahlen
\def\bbbm{{\rm I\!M}}
\def\bbbn{{\rm I\!N}} %natuerliche Zahlen
\def\bbbf{{\rm I\!F}}
\def\bbbh{{\rm I\!H}}
\def\bbbk{{\rm I\!K}}
\def\bbbp{{\rm I\!P}}
\def\bbbone{{\mathchoice {\rm 1\mskip-4mu l} {\rm 1\mskip-4mu l}
{\rm 1\mskip-4.5mu l} {\rm 1\mskip-5mu l}}}
\def\bbbc{{\mathchoice {\setbox0=\hbox{$\displaystyle\rm C$}\hbox{\hbox
to0pt{\kern0.4\wd0\vrule height0.9\ht0\hss}\box0}}
{\setbox0=\hbox{$\textstyle\rm C$}\hbox{\hbox
to0pt{\kern0.4\wd0\vrule height0.9\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptstyle\rm C$}\hbox{\hbox
to0pt{\kern0.4\wd0\vrule height0.9\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptscriptstyle\rm C$}\hbox{\hbox
to0pt{\kern0.4\wd0\vrule height0.9\ht0\hss}\box0}}}}
\def\bbbq{{\mathchoice {\setbox0=\hbox{$\displaystyle\rm
Q$}\hbox{\raise
0.15\ht0\hbox to0pt{\kern0.4\wd0\vrule height0.8\ht0\hss}\box0}}
{\setbox0=\hbox{$\textstyle\rm Q$}\hbox{\raise
0.15\ht0\hbox to0pt{\kern0.4\wd0\vrule height0.8\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptstyle\rm Q$}\hbox{\raise
0.15\ht0\hbox to0pt{\kern0.4\wd0\vrule height0.7\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptscriptstyle\rm Q$}\hbox{\raise
0.15\ht0\hbox to0pt{\kern0.4\wd0\vrule height0.7\ht0\hss}\box0}}}}
\def\bbbt{{\mathchoice {\setbox0=\hbox{$\displaystyle\rm
T$}\hbox{\hbox to0pt{\kern0.3\wd0\vrule height0.9\ht0\hss}\box0}}
{\setbox0=\hbox{$\textstyle\rm T$}\hbox{\hbox
to0pt{\kern0.3\wd0\vrule height0.9\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptstyle\rm T$}\hbox{\hbox
to0pt{\kern0.3\wd0\vrule height0.9\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptscriptstyle\rm T$}\hbox{\hbox
to0pt{\kern0.3\wd0\vrule height0.9\ht0\hss}\box0}}}}
\def\bbbs{{\mathchoice
{\setbox0=\hbox{$\displaystyle     \rm S$}\hbox{\raise0.5\ht0\hbox
to0pt{\kern0.35\wd0\vrule height0.45\ht0\hss}\hbox
to0pt{\kern0.55\wd0\vrule height0.5\ht0\hss}\box0}}
{\setbox0=\hbox{$\textstyle        \rm S$}\hbox{\raise0.5\ht0\hbox
to0pt{\kern0.35\wd0\vrule height0.45\ht0\hss}\hbox
to0pt{\kern0.55\wd0\vrule height0.5\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptstyle      \rm S$}\hbox{\raise0.5\ht0\hbox
to0pt{\kern0.35\wd0\vrule height0.45\ht0\hss}\raise0.05\ht0\hbox
to0pt{\kern0.5\wd0\vrule height0.45\ht0\hss}\box0}}
{\setbox0=\hbox{$\scriptscriptstyle\rm S$}\hbox{\raise0.5\ht0\hbox
to0pt{\kern0.4\wd0\vrule height0.45\ht0\hss}\raise0.05\ht0\hbox
to0pt{\kern0.55\wd0\vrule height0.45\ht0\hss}\box0}}}}
\def\bbbz{{\mathchoice {\hbox{$\sf\textstyle Z\kern-0.4em Z$}}
{\hbox{$\sf\textstyle Z\kern-0.4em Z$}}
{\hbox{$\sf\scriptstyle Z\kern-0.3em Z$}}
{\hbox{$\sf\scriptscriptstyle Z\kern-0.2em Z$}}}}

\def\reals{\bbbr}			% the set of reals R
\def\naturals{\bbbn}			% the set of naturals N


